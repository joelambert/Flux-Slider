/*
 Flux Slider v1.2
 http://www.joelambert.co.uk/flux

 Copyright 2011, Joe Lambert. All rights reserved
 Free to use under the MIT license.
 http://www.opensource.org/licenses/mit-license.php
*/
var flux={version:"1.2"};
flux.slider=function(a,c){if(flux.browser.supportsTransitions){var b=this;this.element=$(a);this.transitions=[];for(var d in flux.transitions)this.transitions.push(d);this.options=$.extend({autoplay:true,transitions:this.transitions,delay:4E3,pagination:true,controls:true},c);this.images=[];this.currentImageIndex=this.imageLoadedCount=0;this.nextImageIndex=1;this.playing=false;this.element.find("img").each(function(e,f){b.images.push(f.cloneNode(false));var g=new Image;g.onload=function(){b.imageLoadedCount++;
b.width=this.width;b.height=this.height;if(b.imageLoadedCount>=b.images.length){b.finishedLoading();b.setupImages()}};g.src=f.src;$(f).remove()});this.container=$('<div class="fluxslider"></div>');this.element.append(this.container);this.imageContainer=$('<div class="images loading"></div>').css({position:"relative",overflow:"hidden","min-height":"100px"});this.container.append(this.imageContainer);this.image1=$('<div class="image1" style="height: 100%; width: 100%"></div>');this.imageContainer.append(this.image1);
this.image2=$('<div class="image2" style="height: 100%; width: 100%"></div>');this.imageContainer.append(this.image2);$(this.image1).css({position:"absolute",top:"0px",left:"0px"});$(this.image2).css({position:"absolute",top:"0px",left:"0px"});this.options.autoplay&&this.start()}else window.console&&window.console.error&&console.error("Flux Slider requires a browser that supports CSS3 transitions")};
flux.slider.prototype={constructor:flux.slider,start:function(){var a=this;this.interval=setInterval(function(){a.transition()},this.options.delay)},stop:function(){clearInterval(this.interval);this.interval=null},isPlaying:function(){return this.interval!=null},next:function(a){this.showImage(this.currentImageIndex+1,a)},prev:function(a){this.showImage(this.currentImageIndex-1,a)},showImage:function(a,c){this.setNextIndex(a);this.stop();this.setupImages();this.transition(c);this.options.autoplay&&
this.start()},finishedLoading:function(){var a=this;this.container.css({width:this.width+"px",height:this.height+"px"});this.imageContainer.removeClass("loading");if(this.options.pagination){this.pagination=$('<ul class="pagination"></ul>').css({margin:"0px",padding:"0px","text-align":"center"});this.pagination.bind("click",function(c){c.preventDefault();a.showImage($(c.target).data("index"))});$(this.images).each(function(c){var b=$('<li data-index="'+c+'">'+(c+1)+"</li>").css({display:"inline-block",
"margin-left":"0.5em",cursor:"pointer"});a.pagination.append(b);c==0&&b.css("margin-left",0).addClass("current")});this.container.append(this.pagination)}$(this.imageContainer).css({width:this.width+"px",height:this.height+"px"});$(this.image1).css({width:this.width+"px",height:this.height+"px"});$(this.image2).css({width:this.width+"px",height:this.height+"px"});this.container.css({width:this.width+"px",height:this.height+(this.options.pagination?this.pagination.height():0)+"px"})},setupImages:function(){this.image1.css({"background-image":'url("'+
this.getImage(this.currentImageIndex).src+'")',"z-index":101}).children().remove();this.image2.css({"background-image":'url("'+this.getImage(this.nextImageIndex).src+'")',"z-index":100});if(this.options.pagination){this.pagination.find("li.current").removeClass("current");$(this.pagination.find("li")[this.currentImageIndex]).addClass("current")}},transition:function(a){if(a==undefined||!flux.transitions[a])a=this.options.transitions[Math.floor(Math.random()*this.options.transitions.length)];(new flux.transitions[a](this,
this.options[a])).run();this.currentImageIndex=this.nextImageIndex;this.setNextIndex(this.currentImageIndex+1)},getImage:function(a){a%=this.images.length;return this.images[a]},setNextIndex:function(a){if(a==undefined)a=this.currentImageIndex+1;this.nextImageIndex=a;if(this.nextImageIndex>this.images.length-1)this.nextImageIndex=0;if(this.nextImageIndex<0)this.nextImageIndex=this.images.length-1},increment:function(){this.currentImageIndex++;if(this.currentImageIndex>this.images.length-1)this.currentImageIndex=
0}};
flux.browser={translate:function(a,c,b){a=a!=undefined?a:0;c=c!=undefined?c:0;b=b!=undefined?b:0;return"translate"+(flux.browser.supports3d?"3d(":"(")+a+"px,"+c+(flux.browser.supports3d?"px,"+b+"px)":"px)")},rotateX:function(a){return flux.browser.rotate("x",a)},rotateY:function(a){return flux.browser.rotate("y",a)},rotateZ:function(a){return flux.browser.rotate("z",a)},rotate:function(a,c){if(!a in{x:"",y:"",z:""})a="z";c=c!=undefined?c:0;return flux.browser.supports3d?"rotate3d("+(a=="x"?"1":"0")+
", "+(a=="y"?"1":"0")+", "+(a=="z"?"1":"0")+", "+c+"deg)":a=="z"?"rotate("+c+"deg)":""}};
$(function(){var a=document.createElement("div");flux.browser.supportsTransitions=false;for(var c=["Webkit","Moz","O","Ms"],b=0;b<c.length;b++)if(c[b]+"Transition"in a.style)flux.browser.supportsTransitions=flux.browser.supportsTransitions||true;flux.browser.supports3d="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix;if(flux.browser.supports3d&&"webkitPerspective"in a.style){a=$('<div id="csstransform3d"></div>');c=$('<style media="(transform-3d), (-webkit-transform-3d)">div#csstransform3d { position: absolute; left: 9px }</style>');
$("body").append(a);$("head").append(c);flux.browser.supports3d=a.get(0).offsetLeft==9;a.remove();c.remove()}});(function(){$.fn.css3=function(a){var c={},b=["webkit","moz","ms","o"],d;for(d in a)for(var e=0;e<b.length;e++)c["-"+b[e]+"-"+d]=a[d];this.css(c);return this};$.fn.transitionEnd=function(a){for(var c=["webkitTransitionEnd","transitionend","oTransitionEnd"],b=0;b<c.length;b++)this.bind(c[b],function(){for(var d=0;d<c.length;d++)$(this).unbind(c[d]);a&&a.call(this)})}})();
flux.transition=function(a,c){this.options=$.extend({requires3d:false,after:function(){}},c);this.slider=a;if(this.options.requires3d&&!flux.browser.supports3d){var b=this;this.options.setup=undefined;this.options.after=undefined;this.options.execute=function(){b.finished()}}};
flux.transition.prototype={constructor:flux.transition,run:function(){this.options.setup&&this.options.setup.call(this);this.slider.image1.css({"background-image":"none"});this.options.execute&&this.options.execute.call(this)},finished:function(){this.options.after&&this.options.after.call(this);this.slider.setupImages()}};flux.transitions={};
flux.transitions.bars=function(a,c){return new flux.transition(a,$.extend({barWidth:60,setup:function(){for(var b=Math.floor(this.slider.image1.width()/this.options.barWidth)+1,d=0;d<b;d++)this.slider.image1.append($("<div></div>").attr("class","bar bar-"+d).css({width:this.options.barWidth+"px",height:"100%",position:"absolute",top:"0",left:d*this.options.barWidth+"px","background-image":this.slider.image1.css("background-image"),"background-position":"-"+d*this.options.barWidth+"px 0px"}).css3({"transition-duration":"400ms",
"transition-timing-function":"ease-in","transition-property":"all","transition-delay":d*40+"ms"}))},execute:function(){var b=this,d=this.slider.image1.height(),e=this.slider.image1.find("div.bar");$(e[e.length-1]).transitionEnd(function(){b.finished()});e.css({opacity:"0.5"}).css3({transform:flux.browser.translate(0,d)})}},c))};
flux.transitions.bars3d=function(a,c){return new flux.transition(a,$.extend({requires3d:true,barWidth:100,setup:function(){var b=Math.floor(this.slider.image1.width()/this.options.barWidth)+1;this.options.barWidth=Math.floor(this.slider.image1.width()/b);for(var d=this.slider.image1.width()-b*this.options.barWidth,e=Math.ceil(d/b),f=this.slider.image1.height(),g=0,h=0;h<b;h++){var i=this.options.barWidth;if(d>0){var j=d>=e?e:d;i+=j;d-=j}j=$('<div class="bar bar-'+h+'"></div>').css({width:i+"px",height:"100%",
position:"absolute",top:"0px",left:"0px","background-image":this.slider.image1.css("background-image"),"background-position":"-"+g+"px 0px","background-repeat":"no-repeat"}).css3({"backface-visibility":"hidden"});var l=$(j.get(0).cloneNode(false)).css({"background-image":this.slider.image2.css("background-image")}).css3({transform:flux.browser.rotateX(90)+" "+flux.browser.translate(0,-f/2,f/2)}),k=$('<div class="side bar bar-'+h+'"></div>').css({width:f+"px",height:f+"px",position:"absolute",top:"0px",
left:"0px",background:"#222"}).css3({transform:flux.browser.rotateY(90)+" "+flux.browser.translate(f/2,0,-f/2)}),m=$(k.get(0).cloneNode(false)).css3({transform:flux.browser.rotateY(90)+" "+flux.browser.translate(f/2,0,i-f/2)});this.slider.image1.append($('<div class="barcontainer"></div>').css({width:i+"px",height:"100%",position:"absolute",top:"0px",left:g+"px"}).css3({"transition-duration":"800ms","transition-timing-function":"linear","transition-property":"all","transition-delay":h*150+"ms","transform-style":"preserve-3d"}).append(j).append(l).append(k).append(m));
g+=i}this.imageContainerOverflow=this.slider.imageContainer.css("overflow");this.slider.imageContainer.css({overflow:"visible"}).css3({perspective:600,"perspective-origin":"50% 50%"})},execute:function(){var b=this,d=this.slider.image1.height(),e=this.slider.image1.find("div.barcontainer");this.slider.image2.hide();$(e[e.length-1]).transitionEnd(function(){b.slider.image2.show();b.slider.imageContainer.css({overflow:b.imageContainerOverflow});b.finished()});this.slider.image1.find("div.barcontainer").css3({transform:flux.browser.rotateX(-90)+
" "+flux.browser.translate(0,d/2,d/2)})}},c))};flux.transitions.blinds=function(a,c){return new flux.transitions.bars(a,$.extend({barWidth:70,execute:function(){var b=this;this.slider.image1.height();var d=this.slider.image1.find("div.bar");$(d[d.length-1]).transitionEnd(function(){b.finished()});d.css({opacity:"0.5"}).css3({transform:"scalex(0.0001)"})}},c))};
flux.transitions.zip=function(a,c){return new flux.transitions.bars(a,$.extend({execute:function(){var b=this,d=this.slider.image1.height(),e=this.slider.image1.find("div.bar");$(e[e.length-1]).transitionEnd(function(){b.finished()});e.each(function(f,g){setTimeout(function(){$(g).css({opacity:"0.3"}).css3({transform:flux.browser.translate(0,f%2?"-"+2*d:d)})},5)})}},c))};
flux.transitions.blocks=function(a,c){return new flux.transition(a,$.extend({blockSize:80,blockDelays:{},maxDelay:0,setup:function(){for(var b=Math.floor(this.slider.image1.width()/this.options.blockSize)+1,d=Math.floor(this.slider.image1.height()/this.options.blockSize)+1,e=0;e<b;e++)for(var f=0;f<d;f++){var g=Math.floor(Math.random()*10*100),h=$("<div></div>").attr("class","block block-"+e+"-"+f).data("id",e+":"+f).css({width:this.options.blockSize+"px",height:this.options.blockSize+"px",position:"absolute",
top:f*this.options.blockSize+"px",left:e*this.options.blockSize+"px","background-image":this.slider.image1.css("background-image"),"background-position":"-"+e*this.options.blockSize+"px -"+f*this.options.blockSize+"px"}).css3({"transition-duration":"350ms","transition-timing-function":"ease-in","transition-property":"all","transition-delay":g+"ms"});this.slider.image1.append(h);if(g>this.options.maxDelay){this.options.maxDelayBlock=h;this.options.maxDelay=g}}},execute:function(){var b=this,d=this.slider.image1.find("div.block");
this.options.maxDelayBlock.transitionEnd(function(){b.finished()});d.each(function(e,f){setTimeout(function(){$(f).css({opacity:"0"}).css3({transform:"scale(0.8)"})},5)})}},c))};
flux.transitions.concentric=function(a,c){return new flux.transition(a,$.extend({blockSize:60,delay:150,alternate:false,setup:function(){for(var b=this.slider.image1.width(),d=this.slider.image1.height(),e=Math.ceil((Math.sqrt(b*b+d*d)-this.options.blockSize)/2/this.options.blockSize)+1,f=0;f<e;f++){var g=2*f*this.options.blockSize+this.options.blockSize;this.slider.image1.append($("<div></div>").attr("class","block block-"+f).css({width:g+"px",height:g+"px",position:"absolute",top:(d-g)/2+"px",left:(b-
g)/2+"px","z-index":100+(e-f),"background-image":this.slider.image1.css("background-image"),"background-position":"center center"}).css3({"border-radius":"1000px","transition-duration":"800ms","transition-timing-function":"linear","transition-property":"all","transition-delay":(e-f)*this.options.delay+"ms"}))}},execute:function(){var b=this,d=this.slider.image1.find("div.block");$(d[0]).transitionEnd(function(){b.finished()});d.each(function(e,f){setTimeout(function(){$(f).css({opacity:"0"}).css3({transform:flux.browser.rotateZ((!b.options.alternate||
e%2?"":"-")+"90")})},5)})}},c))};flux.transitions.warp=function(a,c){return new flux.transitions.concentric(a,$.extend({delay:30,alternate:true},c))};
